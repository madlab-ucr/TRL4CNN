DEBUG 2022-07-28 12:41:43,102 - Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
INFO 2022-07-28 12:41:43,882 - Getting data loaders...
INFO 2022-07-28 12:41:44,922 - num_samples: train=45000, val=5000, test=10000
INFO 2022-07-28 12:41:44,923 - Getting model...
INFO 2022-07-28 12:41:46,175 - Saving model stats...
INFO 2022-07-28 12:41:47,489 - Model:
 ==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
VGG16                                    [1, 10]                   --
├─Sequential: 1-1                        [1, 64, 32, 32]           --
│    └─Conv2d: 2-1                       [1, 64, 32, 32]           1,792
│    └─BatchNorm2d: 2-2                  [1, 64, 32, 32]           128
│    └─ReLU: 2-3                         [1, 64, 32, 32]           --
├─Sequential: 1-2                        [1, 64, 16, 16]           --
│    └─Conv2d: 2-4                       [1, 64, 32, 32]           36,928
│    └─BatchNorm2d: 2-5                  [1, 64, 32, 32]           128
│    └─ReLU: 2-6                         [1, 64, 32, 32]           --
│    └─MaxPool2d: 2-7                    [1, 64, 16, 16]           --
├─Sequential: 1-3                        [1, 128, 16, 16]          --
│    └─Conv2d: 2-8                       [1, 128, 16, 16]          73,856
│    └─BatchNorm2d: 2-9                  [1, 128, 16, 16]          256
│    └─ReLU: 2-10                        [1, 128, 16, 16]          --
├─Sequential: 1-4                        [1, 128, 8, 8]            --
│    └─Conv2d: 2-11                      [1, 128, 16, 16]          147,584
│    └─BatchNorm2d: 2-12                 [1, 128, 16, 16]          256
│    └─ReLU: 2-13                        [1, 128, 16, 16]          --
│    └─MaxPool2d: 2-14                   [1, 128, 8, 8]            --
├─Sequential: 1-5                        [1, 256, 8, 8]            --
│    └─Conv2d: 2-15                      [1, 256, 8, 8]            295,168
│    └─BatchNorm2d: 2-16                 [1, 256, 8, 8]            512
│    └─ReLU: 2-17                        [1, 256, 8, 8]            --
├─Sequential: 1-6                        [1, 256, 8, 8]            --
│    └─Conv2d: 2-18                      [1, 256, 8, 8]            590,080
│    └─BatchNorm2d: 2-19                 [1, 256, 8, 8]            512
│    └─ReLU: 2-20                        [1, 256, 8, 8]            --
├─Sequential: 1-7                        [1, 256, 4, 4]            --
│    └─Conv2d: 2-21                      [1, 256, 8, 8]            590,080
│    └─BatchNorm2d: 2-22                 [1, 256, 8, 8]            512
│    └─ReLU: 2-23                        [1, 256, 8, 8]            --
│    └─MaxPool2d: 2-24                   [1, 256, 4, 4]            --
├─Sequential: 1-8                        [1, 512, 4, 4]            --
│    └─Conv2d: 2-25                      [1, 512, 4, 4]            1,180,160
│    └─BatchNorm2d: 2-26                 [1, 512, 4, 4]            1,024
│    └─ReLU: 2-27                        [1, 512, 4, 4]            --
├─Sequential: 1-9                        [1, 512, 4, 4]            --
│    └─Conv2d: 2-28                      [1, 512, 4, 4]            2,359,808
│    └─BatchNorm2d: 2-29                 [1, 512, 4, 4]            1,024
│    └─ReLU: 2-30                        [1, 512, 4, 4]            --
├─Sequential: 1-10                       [1, 512, 2, 2]            --
│    └─Conv2d: 2-31                      [1, 512, 4, 4]            2,359,808
│    └─BatchNorm2d: 2-32                 [1, 512, 4, 4]            1,024
│    └─ReLU: 2-33                        [1, 512, 4, 4]            --
│    └─MaxPool2d: 2-34                   [1, 512, 2, 2]            --
├─Sequential: 1-11                       [1, 512, 2, 2]            --
│    └─Conv2d: 2-35                      [1, 512, 2, 2]            2,359,808
│    └─BatchNorm2d: 2-36                 [1, 512, 2, 2]            1,024
│    └─ReLU: 2-37                        [1, 512, 2, 2]            --
├─Sequential: 1-12                       [1, 512, 2, 2]            --
│    └─Conv2d: 2-38                      [1, 512, 2, 2]            2,359,808
│    └─BatchNorm2d: 2-39                 [1, 512, 2, 2]            1,024
│    └─ReLU: 2-40                        [1, 512, 2, 2]            --
├─Sequential: 1-13                       [1, 512, 1, 1]            --
│    └─Conv2d: 2-41                      [1, 512, 2, 2]            2,359,808
│    └─BatchNorm2d: 2-42                 [1, 512, 2, 2]            1,024
│    └─ReLU: 2-43                        [1, 512, 2, 2]            --
│    └─MaxPool2d: 2-44                   [1, 512, 1, 1]            --
├─Sequential: 1-14                       [1, 256]                  --
│    └─Dropout: 2-45                     [1, 512]                  --
│    └─Linear: 2-46                      [1, 256]                  131,328
│    └─ReLU: 2-47                        [1, 256]                  --
├─Sequential: 1-15                       [1, 128]                  --
│    └─Dropout: 2-48                     [1, 256]                  --
│    └─Linear: 2-49                      [1, 128]                  32,896
│    └─ReLU: 2-50                        [1, 128]                  --
├─Sequential: 1-16                       [1, 10]                   --
│    └─Linear: 2-51                      [1, 10]                   1,290
==========================================================================================
Total params: 14,888,650
Trainable params: 14,888,650
Non-trainable params: 0
Total mult-adds (M): 313.65
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 4.43
Params size (MB): 59.55
Estimated Total Size (MB): 63.99
==========================================================================================
INFO 2022-07-28 12:41:47,490 - Training...
INFO 2022-07-28 12:41:47,490 - 	 Model: baseline
INFO 2022-07-28 12:41:47,490 - 	 learning_rate = 0.001
INFO 2022-07-28 12:41:47,490 - 	 num_epochs = 20
INFO 2022-07-28 12:41:47,490 - 	 optimizer = {'state': {}, 'param_groups': [{'lr': 0.001, 'momentum': 0.9, 'dampening': 0, 'weight_decay': 0.005, 'nesterov': False, 'initial_lr': 0.001, 'params': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57]}]}
INFO 2022-07-28 12:41:47,490 - 	 scheduler = {'gamma': 0.9, 'base_lrs': [0.001], 'last_epoch': 0, '_step_count': 1, 'verbose': False, '_get_lr_called_within_step': False, '_last_lr': [0.001]}
INFO 2022-07-28 12:44:39,142 - Done training. Elapsed time = 0:02:51.652252
INFO 2022-07-28 12:44:39,142 - Plotting training mterics...
INFO 2022-07-28 12:44:39,288 - Calculating metrics on testset...
INFO 2022-07-28 12:44:40,573 - Test Accuracy = 0.7811511075949367
